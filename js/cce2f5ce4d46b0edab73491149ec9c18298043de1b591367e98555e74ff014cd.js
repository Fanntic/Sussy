!function(){"use strict";function e(){return{retryable:!0,withCredentials:!0,url:"".concat(V,"/v1/email")}}var t={n:function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},n=CoreUtilities,r=React,i=t.n(r),o=ReactDOM,a=Roblox,c=t.n(a),l=PropTypes,s=t.n(l),u=ReactUtilities,d="verificationUpsell-container",p={common:[],feature:"Feature.VerificationUpsell"},m="SET_USER_EMAIL_STATES",f="SET_MODAL_STATES",v="SET_PAGENAME_STATE",y="SET_INPUT_STATE",h="SET_ERROR_STATE",b="SET_EMAIL_SENT_STATE",g="SET_RESEND_EMAIL_STATE",E="SET_EMAIL_UPDATING_STATE",P="SET_TRIGGER_ORIGIN",S="SET_INPUT_CLEAR",C="SET_EMAIL_ADDED_STATE",x="Verification",N="UpdateEmail",w="logout",A="homepage",O="Description.PleaseEnterEmail",T="Description.PleaseEnterParentEmail",M="Description.LogoutAddEmailTextOver13",k="Description.LogoutAddEmailTextUnder13",R="Heading.PleaseAddEmail",I="Heading.AddEmail",D="Heading.VerifyEmail",j="Heading.VerifyOnLogout",U="Label.EmailInputPlaceholderOver13",_="Label.EmailInputPlaceholderUnder13",L="Message.ConfirmationEmailNotSent",B="Message.InvalidEmailAddress",H="Response.ErrorTryAgain",V=(l="Response.TooManyAttemptsTryAgainLater",a.EnvironmentUrls.accountSettingsApi),q=a.EnvironmentUrls.authApi,F=a.EnvironmentUrls.apiGatewayUrl,G=a.EnvironmentUrls.apiProxyUrl,W=a.EnvironmentUrls.accountInformationApi,Y={header:"alt_title",body:"alt_body",primaryButton:"alt_primary_button_text",secondaryButton:"alt_secondary_button_text"};function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function z(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?z(Object(n),!0).forEach((function(t){var r,i;r=e,t=n[i=t],i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):z(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function X(e,t){switch(t.type){case S:return K(K({},e),{},{userEmailInput:""});case P:return K(K({},e),{},{origin:t.origin,skipCallback:t.skipCallback,closeCallback:t.closeCallback});case m:return K(K({},e),{},{isEmailVerified:t.isEmailVerified,userEmail:t.userEmail});case v:return K(K({},e),{},{pageName:t.pageName});case h:return K(K({},e),{},{errorMsg:t.errorMsg});case E:return K(K({},e),{},{isEmailUpdating:t.isEmailUpdating});case b:return K(K({},e),{},{isEmailSent:!0});case C:return K(K({},e),{},{isEmailAdded:!0});case g:return K(K({},e),{},{isEmailSent:!1});case y:return e.pageName===N?K(K({},e),{},{userEmailInput:t.value,errorMsg:""}):e;case f:if(e.pageName!==N)return K(K({},e),{},{pageName:x,titleText:se,bodyText:ie,primaryButtonText:Z,secondaryButtonText:ee,errorMsg:""});var n,r,i,o=a.CurrentUser&&!a.CurrentUser.isUnder13,c=Q,l="";switch(e.skipCallback&&(l=ne),e.origin){case w:r=pe,i=o?ce:le,l=te,t.experimentParameters&&(r=null!==(n=t.experimentParameters[Y.header])&&void 0!==n?n:r,i=null!==(n=t.experimentParameters[Y.body])&&void 0!==n?n:i,c=null!==(n=t.experimentParameters[Y.primaryButton])&&void 0!==n?n:c,l=null!==(n=t.experimentParameters[Y.secondaryButton])&&void 0!==n?n:l);break;case A:r=de,i=o?ve:ye,c=re;break;default:r=ue,i=o?oe:ae}return K(K({},e),{},{pageName:N,titleText:r,bodyText:i,primaryButtonText:c,secondaryButtonText:l,errorMsg:"",userEmailInputPlaceholder:o?me:fe});default:return e}}function J(e){var t=e.children,n=(e=(n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return $(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?$(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useReducer)(X,he),2))[0],n[1]);return i().createElement(be.Provider,{value:{emailUpsellState:e,dispatch:n}},t)}var Q="Action.SendConfirmationEmail",Z="Action.ResendConfirmationEmail",ee="Action.ChangeEmail",te="Action.Logout",ne="Action.GenericSkip",re="Action.Continue",ie="Description.VerifyEmailBody",oe="Description.AddEmailTextOver13",ae="Description.AddEmailTextUnder13",ce=M,le=k,se=D,ue=I,de=R,pe=j,me=U,fe=_,ve=O,ye=T,he={pageName:"",isModalOpen:!1,isEmailVerified:!1,isEmailSent:!1,isEmailUpdating:!1,isEmailAdded:!1,origin:"",experimentParameters:null,userEmail:"",userEmailInput:"",userEmailInputPlaceholder:me,errorMsg:"",titleText:se,bodyText:ie,primaryButtonText:Z,secondaryButtonText:ee,skipCallback:null,closeCallback:null},be=(0,r.createContext)(he);function ge(){return(0,r.useContext)(be)}J.propTypes={children:s().node.isRequired};var Ee=ReactStyleGuide,Pe=(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isAndroidApp;function Se(e){var t=e.show,n=e.onHide,r=e.onPrimaryAction,o=e.onSecondaryAction,a=e.onInputChange,c=e.onBackAction,l=e.onInputFocus,s=e.onKeyDown,u=e.translate,d=(E=ge().emailUpsellState).pageName,p=E.titleText,m=E.bodyText,f=E.primaryButtonText,v=E.secondaryButtonText,y=E.userEmailInput,h=E.userEmailInputPlaceholder,b=E.userEmail,g=E.errorMsg,E=(e=E.isEmailSent,E.isEmailUpdating);return i().createElement(Ee.Modal,{show:t,onHide:n,className:"".concat(Pe?"verification-android-modal":""," verification-modal"),size:"lg","aria-labelledby":"contained-modal-title-vcenter",scrollable:"true",centered:"true"},i().createElement(Ee.Modal.Header,{useBaseBootstrapComponent:!0},i().createElement("div",{className:"verification-upsell-title-container"},"UpdatePassword"===d?i().createElement("button",{type:"button",className:"verification-upsell-title-button",onClick:c},i().createElement("span",{className:"icon-back"})):i().createElement("button",{type:"button",className:"verification-upsell-title-button",onClick:n},i().createElement("span",{className:"close icon-close"})),i().createElement(Ee.Modal.Title,{id:"contained-modal-title-vcenter"},u(p)))),i().createElement(Ee.Modal.Body,null,i().createElement("div",{className:"email-verification-upsell-image"}),i().createElement("p",{className:"verification-upsell-text-body"},u(m,{emailAddress:b})),d===N&&i().createElement("input",{type:"email",autoFocus:!0,className:"".concat(g?"input-field-error":""," form-control input-field verification-upsell-modal-input"),placeholder:u(h),autoComplete:"email",value:y,onChange:function(e){return a(e.target.value)},onFocus:function(){return l()},onKeyDown:function(e){return s(e.key)}}),g&&i().createElement("p",{className:"text-error modal-error-message sms-code-error"},u(g))),i().createElement(Ee.Modal.Footer,null,i().createElement("div",{className:"verification-upsell-footer-container"},d!==x&&i().createElement(Ee.Button,{className:"modal-button verification-upsell-btn",variant:Ee.Button.variants.cta,size:Ee.Button.sizes.medium,isDisabled:E,onClick:r},u(f)),d===x&&i().createElement("button",{type:"button",className:"".concat(e?"resend-button-disabled":""," resend-verification-email-button"),disabled:e||g,onClick:r},u(f)),v&&i().createElement("button",{type:"button",className:"change-email-button",onClick:o},u(v)))))}function Ce(e){var t=null==e||null===(t=e.data)||void 0===t?void 0:t.errors;return t&&t[0]&&t[0].code}Se.propTypes={translate:s().func.isRequired,onHide:s().func.isRequired,show:s().bool.isRequired,onPrimaryAction:s().func.isRequired,onSecondaryAction:s().func.isRequired,onInputChange:s().func.isRequired,onKeyDown:s().func.isRequired,onBackAction:s().func.isRequired,onInputFocus:s().func.isRequired};var xe=Se,Ne="unset";M="homepage";function we(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function Ae(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){we(o,r,i,a,c,"next",e)}function c(e){we(o,r,i,a,c,"throw",e)}a(void 0)}))}}function Oe(t){var r=e();return n.httpService.get(r).then((function(e){var n=e.data;return null!=n&&n.emailAddress&&(!t.requireVerification||n.verified)||(e=new CustomEvent("OpenVerificationModal",{detail:{isEmailVerified:n.verified,email:null==n?void 0:n.emailAddress,skipCallback:t.skipCallback,origin:t.origin,experimentParameters:null==t?void 0:t.experimentParameters,requireVerification:t.requireVerification,closeCallback:t.closeCallback}}),window.dispatchEvent(e)),n}),(function(e){return console.log(e),!1}))}function Te(e){return Oe({origin:A,closeCallback:e})}function Me(e){switch(e){case x:return"verifyEmail";case N:return"addEmail";default:return""}}var ke=function(){var e=Ae(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={retryable:!0,withCredentials:!0,url:"".concat(q,"/v2/metadata")},e.abrupt("return",n.httpService.get(t));case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Re=function(){var e=Ae(regeneratorRuntime.mark((function e(){var t,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t={retryable:!0,withCredentials:!0,url:"".concat(F,"/product-experimentation-platform/v1/projects/1/layers/Website.Logout.ContactMethodModal/values")},r={parameters:Object.values(Y).join(",")},e.abrupt("return",n.httpService.get(t,r));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Ie=(k=function(){var e=Ae(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ke();case 2:if(null!==(n=(n=e.sent).data)&&void 0!==n&&n.IsEmailUpsellAtLogoutEnabled){e.next=5;break}return e.abrupt("return",!1);case 5:return e.next=7,Re();case 7:return n=e.sent,e.abrupt("return",Oe({origin:w,experimentParameters:null==n?void 0:n.data,skipCallback:t}));case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),B),De=l,je=H,Ue=D=9,_e=CoreRobloxUtilities;function Le(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function Be(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Le(Object(n),!0).forEach((function(t){var r,i;r=e,t=n[i=t],i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function He(e,t){_e.eventStreamService.sendEventWithTarget(e.type,e.context,Be(Be({},e.params),{},{origin:t.origin,section:t.section}))}function Ve(e,t){return(e=Be({},e)).params=Be(Be({},e.params),{},{errorCode:t}),e}R="verificationUpsell";var qe={showModal:{name:"showModal",type:(I=_e.eventStreamService.eventTypes).modalAction,context:R,params:{aType:"shown"}},dismissModal:{name:"dismissModal",type:I.modalAction,context:R,params:{aType:"dismissed"}},touchEmail:{name:"touchEmail",type:I.formInteraction,context:R,params:{aType:"focus",field:"email"}},showError:{name:"showError",type:I.formInteraction,context:R,params:{aType:"shown",field:"errorMessage"}},clickContinue:{name:"clickContinue",type:I.formInteraction,context:R,params:{btn:"continue"}},clickSendConfirmationEmail:{name:"clickSendConfirmationEmail",type:I.formInteraction,context:R,params:{aType:"click",btn:"sendConfirmation"}},clickResendConfirmationEmail:{name:"clickResendConfirmationEmail",type:I.formInteraction,context:R,params:{aType:"click",btn:"resendConfirmation"}},clickChangeEmail:{name:"clickChangeEmail",type:I.formInteraction,context:R,params:{aType:"click",btn:"changeEmail"}},skipLogoutAnyway:{name:"skipLogoutAnyway",type:I.formInteraction,context:R,params:{aType:"click",btn:"skipLogoutAnyway"}},skipPrepurchaseVerification:{name:"skipPrepurchaseVerification",type:I.formInteraction,context:R,params:{aType:"click",btn:"skipPrepurchaseVerification"}}};function Fe(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Ge=L,We=B,Ye=D;function $e(t){var o,a=t.translate,c=(t=(o=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Fe(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Fe(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(!1),2))[0],o[1]),l=(o=ge()).emailUpsellState,s=o.dispatch;function u(){var t,r,i=Me(l.pageName);switch(l.pageName){case x:He(qe.clickResendConfirmationEmail,{origin:l.origin,section:i}),function(){var e={retryable:!0,withCredentials:!0,url:"".concat(V,"/v1/email/verify")};return n.httpService.post(e).then((function(){return!0}),Ce)}().then((function(e){!0!==e?(s({type:h,errorMsg:Ge}),He(e=Ve(qe.showError,e),{origin:l.origin,section:i})):(s({type:b}),setTimeout((function(){s({type:g})}),15e3))}));break;case N:He(qe.clickContinue,{origin:l.origin,section:i}),r=l.userEmailInput,/\S+@\S+\.\S+/.test(r)?(He(qe.clickSendConfirmationEmail,{origin:l.origin,section:i}),s({type:E,isEmailUpdating:!0}),t={emailAddress:l.userEmailInput},r=e(),n.httpService.post(r,t).then((function(){return!0}),Ce).then((function(e){var t,n;!0!==e?(n=function(e){switch(e){case 6:return De;case Ue:return Ie;default:return je}}(e),He(t=Ve(qe.showError,e),{origin:l.origin,section:i}),s({type:h,errorMsg:n}),s({type:E,isEmailUpdating:!1})):(s({type:m,isEmailVerified:!1,userEmail:(e=l.userEmailInput,t=e.indexOf("@"),n=e.substring(0,1),"".concat(n,"*****").concat(e.substring(t)))}),s({type:S}),s({type:v,pageName:x}),s({type:f}),s({type:E,isEmailUpdating:!1}),s({type:C}))})),s({type:f})):(He(t=Ve(qe.showError,Ye),{origin:l.origin,section:i}),s({type:h,errorMsg:We}))}}return(0,r.useEffect)((function(){l.pageName&&He(qe.showModal,{origin:origin,section:Me(l.pageName)})}),[l.pageName]),(0,r.useEffect)((function(){window.addEventListener("OpenVerificationModal",(function(e){c(!0),s({type:P,origin:e.detail.origin,skipCallback:e.detail.skipCallback,closeCallback:e.detail.closeCallback}),s({type:m,isEmailVerified:e.detail.isEmailVerified,userEmail:e.detail.email});var t=e.detail.requireVerification&&e.detail.email?x:N;s({type:v,pageName:t}),s({type:f,experimentParameters:null===(e=e.detail)||void 0===e?void 0:e.experimentParameters})}),!1)}),[]),i().createElement("div",null,i().createElement(xe,{show:t,onHide:function(){return He(qe.dismissModal,{origin:l.origin,section:Me(l.pageName)}),s({type:S}),l.closeCallback&&l.closeCallback(l.isEmailAdded),void c(!1)},onPrimaryAction:u,onSecondaryAction:function(){var e=Me(l.pageName);switch(l.pageName){case x:He(qe.clickChangeEmail,{origin:l.origin,section:e}),s({type:v,pageName:N}),s({type:f});break;case N:l.skipCallback&&(He(l.origin===w?qe.skipLogoutAnyway:qe.skipPrepurchaseVerification,{origin:l.origin,section:e}),l.skipCallback()),s({type:S}),c(!1)}},onInputFocus:function(){He(qe.touchEmail,{origin:l.origin,section:Me(l.pageName)})},onInputChange:function(e){s({type:y,pageName:N,value:e})},onKeyDown:function(e){return"Enter"===e&&u()},onBackAction:function(){return s({type:v,pageName:N}),void s({type:f})},translate:a}))}$e.propTypes={translate:s().func.isRequired};var ze=$e;function Ke(e){return e=e.translate,i().createElement(J,null,i().createElement(ze,{translate:e}))}Ke.propTypes={translate:s().func.isRequired};var Xe=(0,u.withTranslations)(Ke,p),Je="CLOSE_PHONE_NUMBER_MODAL",Qe="SET_ERROR_MESSAGE",Ze="SET_PHONE_NUMBER",et="SET_COUNTRY",tt="SET_PAGE",nt="SET_PHONE_VERIFICATION_STATUS",rt="SET_PREFIX_OPTIONS_LIST",it="SET_LOGGING_VALUES",ot="SET_DISCOVERABILITY_CONSENT_PREFILL",at=(j="Action.AddPhoneNumber","Label.PhoneNumber"),ct=(U="Message.InvalidSmsCode",_="Description.VerificationCodeSmsFeesMayApply",O="Description.PhoneNumberNeverPublic",T="Response.PhoneNumberAlreadyLinked",l="Response.TooManyVerificationAttempts",H="Response.PhoneHasTooManyAssociatedAccounts",I="Response.ErrorPhoneFormatInvalid",R="Response.InvalidPhoneNumberError",L="Response.ErrorTryAgain","ADD_PHONE_NUMBER_PAGE"),lt="VERIFY_PHONE_NUMBER_PAGE",st="ADD_PHONE_SUCCESS_PAGE",ut="PHONE_DISCOVERABILITY_CONSENT_PAGE",dt=(D="verificationUpsell",{phoneNumberModalDismissed:{name:"phoneNumberModalDismissed",type:(B=_e.eventStreamService.eventTypes).modalAction,context:D,params:{aType:"dismissed"}},phoneNumberModalShown:{name:"phoneNumberModalShown",type:B.modalAction,context:D,params:{aType:"shown"}},phoneNumberModalErrorShown:{name:"phoneNumberModalErrorShown",type:B.modalAction,context:D,params:{aType:"shown",field:"errorMessage"}},addPhonePrefixPressed:{name:"addPhonePrefixPressed",type:B.formInteraction,context:D,params:{aType:"focus",field:"countryPrefix"}},addPhonePhoneNumberPressed:{name:"addPhonePhoneNumberPressed",type:B.formInteraction,context:D,params:{aType:"focus",field:"phoneNumber"}},addPhoneContinuePressed:{name:"addPhoneContinuePressed",type:B.formInteraction,context:D,params:{btn:"continue"}},verifyPhoneChangePhoneNumberPressed:{name:"verifyPhoneChangePhoneNumberPressed",type:B.formInteraction,context:D,params:{btn:"changePhoneNumber"}},verifyPhoneCodeFieldPressed:{name:"verifyPhoneCodeFieldPressed",type:B.formInteraction,context:D,params:{aType:"focus",field:"verificationCode"}},verifyPhoneContinuePressed:{name:"verifyPhoneContinuePressed",type:B.formInteraction,context:D,params:{btn:"continue"}},verifyPhoneResendPressed:{name:"verifyPhoneResendPressed",type:B.formInteraction,context:D,params:{btn:"resendCode"}},phoneAddedDonePressed:{name:"phoneAddedDonePressed",type:B.formInteraction,context:D,params:{btn:"done"}}});function pt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mt(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function ft(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?mt(Object(n),!0).forEach((function(t){var r,i;r=e,t=n[i=t],i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):mt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function vt(e,t){var n;switch(t.type){case Ze:return ft(ft({},e),{},{phone:t.phone,errorMessage:""});case et:return ft(ft({},e),{},{phonePrefixPickerIndex:t.phonePrefixPickerIndex,errorMessage:""});case Qe:return ft(ft({},e),{},{errorMessage:t.errorMessage});case tt:return ft(ft({},e),{},{errorMessage:"",pageName:t.pageName});case nt:return ft(ft({},e),{},{isPhoneVerified:t.isPhoneVerified});case ot:return ft(ft({},e),{},{shouldPrefillAffirmativeDiscoverabilityConsent:null!==(n=null==t?void 0:t.shouldPrefillAffirmativeDiscoverabilityConsent)&&void 0!==n&&n});case rt:return ft(ft({},e),{},{phonePrefixOptionsList:t.phonePrefixOptionsList});case it:return ft(ft({},e),{},{origin:t.origin});case Je:return ft(ft({},ht),{},{isOpen:!1,errorMessage:""});default:return ht}}function yt(e){var t=e.children,n=(e=(n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return pt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?pt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useReducer)(vt,ht),2))[0],n[1]);return i().createElement(bt.Provider,{value:{phoneUpsellState:e,dispatch:n}},t)}var ht={isOpen:!0,pageName:ct,errorMessage:"",origin:Ne,phone:"",isPhoneVerified:!1,phonePrefixPickerIndex:0,phonePrefixOptionsList:[],shouldDiscoverabilityConsentDefaultYes:!1},bt=(0,r.createContext)(ht);function gt(){return(0,r.useContext)(bt)}function Et(){var e={retryable:!0,withCredentials:!0,url:"".concat(G,"/v1/countries/phone-prefix-list")};return n.httpService.get(e).then((function(e){var t,n=e.data,r=null!==(e=null==(e=n.find((function(e){return!0===e.isDefault})))?void 0:e.code)&&void 0!==e?e:At;return n.filter((function(e){return e.code!==r||(t=e,!1)})),t&&n.unshift(t),n}),(function(e){return!1}))}function Pt(e){var t=e.phone,r=e.prefix,i=e.countryCode;e={retryable:!0,withCredentials:!0,url:"".concat(W,"/v1/phone")},t={countryCode:i,prefix:r,phone:t};return n.httpService.post(e,t)}function St(e){var t={code:0<arguments.length&&void 0!==e?e:""};e={retryable:!0,withCredentials:!0,url:"".concat(W,"/v1/phone/verify")};return n.httpService.post(e,t)}function Ct(e){var t={retryable:!0,withCredentials:!0,url:"".concat(W,"/v1/phone/resend")};return n.httpService.post(t,e).then((function(e){return e.data,!0}),(function(e){return!1}))}function xt(e){switch(e){case ct:return"addPhone";case lt:return"verifyPhone";case st:return"phoneAdded";case ut:return"discoverabilityConsent";default:return""}}yt.propTypes={children:s().node.isRequired};var Nt=function(e){return"+".concat(e)},wt=function(e,t){return"".concat(e," +(").concat(t,")")},At="US",Ot=T,Tt=l,Mt=I,kt=R,Rt=L,It=H,Dt=U;function jt(e){var t=e.translate;e=gt().phoneUpsellState;return i().createElement("p",{className:"input-field-error-text sms-code-error text-error modal-error-message"},e.errorMessage?t(e.errorMessage):null)}jt.propTypes={translate:s().func.isRequired};var Ut=jt;function _t(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function Lt(e){var t=e.translate,n=(u=gt()).phoneUpsellState,o=u.dispatch,a=Nt,c=wt,l=n.phone,s=(e=n.phonePrefixPickerIndex,n.phonePrefixOptionsList),u=n.pageName,d=n.origin,p=(n="upsell-phone-number-number",xt(u));(0,r.useEffect)((function(){function e(){var t;return t=regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(0===(t=s).length)return e.next=4,Et();e.next=6;break;case 4:t=e.sent,o({type:rt,phonePrefixOptionsList:t});case 6:case"end":return e.stop()}}),e)})),(e=function(){var e=this,n=arguments;return new Promise((function(r,i){var o=t.apply(e,n);function a(e){_t(o,r,i,a,c,"next",e)}function c(e){_t(o,r,i,a,c,"throw",e)}a(void 0)}))}).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]);var m=null!==(m=null==s||null===(m=s[e])||void 0===m?void 0:m.prefix)&&void 0!==m?m:"";return i().createElement("div",null,i().createElement("label",{htmlFor:n},i().createElement("p",{className:"verification-code-label font-caption-header text-primary"},t(at))),i().createElement("div",{id:"upsell-phone",className:"phone-number-input-container input-field form-control"},i().createElement("div",{id:"upsell-phonenumber",className:"phone-input-row"},i().createElement("span",{className:"phone-prefix-wrapper"},i().createElement("div",{className:"phone-prefix-selected text"},a(m)),i().createElement("select",{className:"phone-prefix-dropdown input-field rbx-select",onChange:function(e){e=e.target.value,o({type:et,phonePrefixPickerIndex:e})},onFocus:function(){He(dt.addPhonePrefixPressed,{origin:d,section:p})},value:e},s.map((function(e,t){return i().createElement("option",{className:"prefix-option",value:t},c(e.localizedName,e.prefix))})))),i().createElement("div",{id:"upsell-phonenumber-divider",className:"phone-divider"}),i().createElement("input",{id:n,type:"tel",value:l,className:"phone-input form-control",placeholder:t(at),autoComplete:"tel-national",onChange:function(e){return o({type:Ze,phone:e.target.value})},onFocus:function(){He(dt.addPhonePhoneNumberPressed,{origin:d,section:p})}}))))}Lt.propTypes={translate:s().func.isRequired};var Bt=Lt;function Ht(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function Vt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var qt=j,Ft=_,Gt=O,Wt=(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isInApp;function Yt(e){var t,n=e.translate,o=e.onHide,a=(t=gt()).phoneUpsellState,c=t.dispatch,l=a.phone,s=a.phonePrefixPickerIndex,u=a.phonePrefixOptionsList,d=(e=a.pageName,a.origin),p=(a=(t=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Vt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Vt(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useState)(!1),2))[0],t[1]),m=xt(e),f=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),n=u[s],t=n.prefix,n=n.code,He(dt.addPhoneContinuePressed,{origin:d,section:m}),e.next=5,Pt({phone:l,prefix:t,countryCode:n}).then((function(){c({type:tt,pageName:lt})})).catch((function(e){var t=Ce(e);He(e=Ve(dt.phoneNumberModalErrorShown,t),{origin:d,section:m}),c({type:Qe,errorMessage:function(e){switch(e){case 3:return Ot;case 6:return Tt;case 2:return Mt;case 8:return kt;case 9:return It;default:return Rt}}(t)})})).finally((function(){p(!1)}));case 5:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){Ht(o,r,i,a,c,"next",e)}function c(e){Ht(o,r,i,a,c,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}();return i().createElement("div",null,i().createElement(Ee.Modal.Header,{useBaseBootstrapComponent:!0},i().createElement("div",{className:"verification-upsell-title-container"},i().createElement("button",{type:"button",hidden:Wt,className:"verification-upsell-title-button",onClick:o},i().createElement("span",{className:"close icon-close"})),i().createElement(Ee.Modal.Title,{id:"contained-modal-title-vcenter"},n(qt)))),i().createElement(Ee.Modal.Body,null,i().createElement("div",{className:"phone-number-submission-container"},i().createElement("div",{className:"verification-upsell-text-body text-description"},n(Ft)),i().createElement(Bt,{translate:n}),i().createElement(Ut,{translate:n}))),i().createElement(Ee.Modal.Footer,null,i().createElement("div",{className:"phone-verification-nonpublic-text text-description font-caption-body"},n(Gt)),i().createElement("div",{className:"buttons-section"},i().createElement(Ee.Button,{type:"button",id:"add-phone-number-continue-button",className:"accept-btn",variant:Ee.Button.variants.primary,isDisabled:a||0===l.length,onClick:function(){return f()}},n("Action.Continue")))))}Yt.propTypes={translate:s().func.isRequired,onHide:s().func.isRequired};var $t=Yt;function zt(e){var t=e.translate,n=(l=gt()).phoneUpsellState,r=l.dispatch,o=n.origin,c=n.pageName,l=(e="Heading.PhoneIsVerified","Description.PhoneForRecovery"),s=(n="Action.Done",(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isInApp),u=xt(c);return i().createElement("div",null,i().createElement(Ee.Modal.Body,null,i().createElement("div",{className:"phone-number-verification-upsell-image"}),i().createElement("div",{className:"verification-upsell-title-container phone-number-verification-success-page-title page-title"},i().createElement(Ee.Modal.Title,{id:"contained-modal-title-vcenter"},t(e))),i().createElement("div",{className:"phone-number-verification-text-body text-description"},t(l))),i().createElement(Ee.Modal.Footer,null,i().createElement("button",{type:"button",className:"btn-cta-md btn-max-width phone-number-verify-button",onClick:function(){He(dt.phoneAddedDonePressed,{origin:o,section:u}),s&&a.Hybrid&&a.Hybrid.Navigation?a.Hybrid.Navigation.navigateToFeature({feature:"CloseContactMethodUpsellWebview"}):r({type:Je})}},t(n))))}function Kt(){var e={retryable:!0,withCredentials:!0,url:"".concat(F,"/user-settings-api/v1/user-settings/metadata")};return n.httpService.get(e).then((function(e){return e.data}),(function(e){return null}))}function Xt(e){var t={retryable:!0,withCredentials:!0,url:"".concat(F,"/user-settings-api/v1/user-settings")};e={phoneNumberDiscoverability:e};return n.httpService.post(t,e).then((function(e){return!0})).catch((function(){return!1}))}zt.propTypes={translate:s().func.isRequired};var Jt=zt,Qt="NotDiscoverable",Zt="Discoverable";function en(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?tn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function tn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nn(e){var t=e.translate,n=e.shouldPrefillAffirmativeDiscoverabilityConsent,o=e.origin,c=gt().dispatch,l=(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isInApp,s=(d=en((0,r.useState)(n?Zt:"Unset"),2))[0],u=d[1],d=(e=en((0,r.useState)(!1),2))[0],p=e[1];e=function(e){u(e.currentTarget.value),_e.eventStreamService.sendEventWithTarget("discoverabilityPageRadioButtonClick",e.currentTarget.value,{origin:o})};return(0,r.useEffect)((function(){_e.eventStreamService.sendEventWithTarget("discoverabilityPageLoad","phoneVerificationUpsell",{version:n?"non_eu_version":"eu_version",origin:o})}),[]),i().createElement("div",{className:"phone-discoverability-consent"},i().createElement(Ee.Modal.Body,{className:"verification-grid"},i().createElement("span",{className:"icon-spot-success-xl verification-grid-icon"}),i().createElement("div",{className:"discoverability-text-section"},i().createElement("div",{className:"verification-upsell-title-container page-title "},i().createElement(Ee.Modal.Title,null,t("Header.PhoneIsVerified"))),i().createElement("div",{className:"text-description"},t("Description.CanUsePhoneForRecovery"))),i().createElement("span",{className:"icon-spot-find-friends-xl verification-grid-icon"}),i().createElement("div",{className:"discoverability-text-section"},i().createElement("div",{className:"verification-upsell-title-container page-title"},i().createElement(Ee.Modal.Title,null,t("Header.LetFriendsFindYou"))),i().createElement("div",{className:"text-description"},t("Description.WantToBeRecommendedViaPhone"))),i().createElement("div",{className:"verification-grid-icon"}),i().createElement("div",{className:"discoverability-radio-button-section"},i().createElement("div",{className:"radio discoverability-consent-option"},i().createElement("input",{type:"radio",name:"discoverability-options",id:"consent-radio-button",value:Zt,checked:s===Zt,onClick:e}),i().createElement("label",{className:"text-description",htmlFor:"consent-radio-button"},t("Label.Yes"))),i().createElement("div",{className:"radio discoverability-consent-option"},i().createElement("input",{type:"radio",name:"discoverability-options",id:"no-consent-radio-button",value:Qt,checked:s===Qt,onClick:e}),i().createElement("label",{className:"text-description",htmlFor:"no-consent-radio-button"},t("Label.No")))),i().createElement("div",{className:"verification-grid-icon"}),i().createElement("div",null,i().createElement("div",{className:"text-secondary"},t("Description.PhoneDiscoverabilityPrivacy")),i().createElement("a",{className:"text-secondary text-link learn-more-link",target:"_blank",rel:"noreferrer",href:"https://en.help.roblox.com/hc/articles/7416652004884"},t("Action.LearnMore")))),i().createElement(Ee.Modal.Footer,null,i().createElement(Ut,{translate:t}),i().createElement("button",{type:"button",className:"btn-cta-md btn-max-width phone-number-verify-button",disabled:d,onClick:function(){p(!0),_e.eventStreamService.sendEventWithTarget("discoverabilityPageClick",s,{origin:o}),Xt(s).then((function(e){return!0!==e?(p(!1),void c({type:Qe,errorMessage:"Response.ErrorTryAgain"})):(c({type:Qe,errorMessage:""}),void(l&&a.Hybrid&&a.Hybrid.Navigation?a.Hybrid.Navigation.navigateToFeature({feature:"CloseContactMethodUpsellWebview"}):c({type:Je})))}))}},t("Action.Done"))))}nn.propTypes={origin:s().string.isRequired,translate:s().func.isRequired,shouldPrefillAffirmativeDiscoverabilityConsent:s().bool.isRequired};var rn=nn;function on(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function an(e){return e.replace(/[^0-9]/g,"").substring(0,ln)}var cn=function(){var e,t=(e=regeneratorRuntime.mark((function e(){var t,n,r;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(t=st),e.next=4,Kt();case 4:return!0===(null==(r=e.sent)?void 0:r.isDiscoverabilitySettingsEnabled)&&!0===(null==r?void 0:r.showDiscoverabilityUpsells)&&(t=ut,n=!0===(null==r?void 0:r.prefillDiscoverabilitySetting)),e.abrupt("return",{successPage:t,shouldPrefillAffirmativeDiscoverabilityConsent:n});case 7:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){on(o,r,i,a,c,"next",e)}function c(e){on(o,r,i,a,c,"throw",e)}a(void 0)}))});return function(){return t.apply(this,arguments)}}(),ln=6;function sn(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function un(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?sn(Object(n),!0).forEach((function(t){var r,i;r=e,t=n[i=t],i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):sn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function dn(e,t,n,r,i,o,a){try{var c=e[o](a),l=c.value}catch(e){return void n(e)}c.done?t(l):Promise.resolve(l).then(r,i)}function pn(e){return function(){var t=this,n=arguments;return new Promise((function(r,i){var o=e.apply(t,n);function a(e){dn(o,r,i,a,c,"next",e)}function c(e){dn(o,r,i,a,c,"throw",e)}a(void 0)}))}}function mn(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return fn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?fn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function fn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vn(e){var t=e.translate,n=e.onHide,o=(N=gt()).phoneUpsellState,c=N.dispatch,l=o.phone,s=o.phonePrefixOptionsList,u=o.phonePrefixPickerIndex,d=o.pageName,p=o.origin,m="CompletedContactMethodUpsellWebview",f=(w=mn((0,r.useState)({code:"",isReadyToSubmitCode:""}),2))[0],v=w[1],y=(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isInApp,h=y,b=xt(d),g=(A=mn((0,r.useState)(0),2))[0],E=A[1],P=(O=mn((0,r.useState)(!1),2))[0],S=O[1],C=(T=mn((0,r.useState)(st),2))[0],x=T[1],N=(e="Action.ResendCode","Action.CodeResent"),w="Label.EnterCode",A=(d="Heading.VerificationCode","verification-code-input"),O=" (",T=")";l=function(e,t){return"\n+".concat(e).concat(t)}(s[u].prefix,l);function M(){return(M=pn(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(He(dt.verifyPhoneContinuePressed,{origin:p,section:b}),6!==f.code.length)return e.abrupt("return");e.next=3;break;case 3:return S(!0),c({type:Qe,errorMessage:""}),e.prev=5,e.next=8,St(f.code);case 8:c({type:nt,isPhoneVerified:!0}),c({type:tt,pageName:C}),y&&a.Hybrid&&a.Hybrid.Navigation&&a.Hybrid.Navigation.navigateToFeature({feature:m}),e.next=20;break;case 13:e.prev=13,e.t0=e.catch(5),n=Ce(e.t0),t=function(e){switch(e){case 6:return Tt;case 7:return Dt;default:return Rt}}(n),He(n=Ve(dt.phoneNumberModalErrorShown,n),{origin:p,section:b}),c({type:Qe,errorMessage:t});case 20:return e.prev=20,v(un(un({},f),{},{isReadyToSubmitCode:!1})),S(!1),e.finish(20);case 24:case"end":return e.stop()}}),e,null,[[5,13,20,24]])})))).apply(this,arguments)}return(0,r.useEffect)((function(){function e(){return(e=pn(regeneratorRuntime.mark((function e(){var t,n;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,cn();case 2:n=e.sent,t=n.successPage,n=n.shouldPrefillAffirmativeDiscoverabilityConsent,c({type:ot,shouldPrefillAffirmativeDiscoverabilityConsent:n}),x(t);case 7:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[]),(0,r.useEffect)((function(){f.isReadyToSubmitCode&&function(){M.apply(this,arguments)}()}),[f]),i().createElement("div",null,i().createElement(Ee.Modal.Header,{useBaseBootstrapComponent:!0},i().createElement("div",{className:"verification-upsell-title-container"},i().createElement("button",{type:"button",className:"verification-upsell-title-button",hidden:h,onClick:n},i().createElement("span",{className:"close icon-close"})),i().createElement(Ee.Modal.Title,{id:"contained-modal-title-vcenter"},t("Heading.VerifyYourPhone")))),i().createElement(Ee.Modal.Body,null,i().createElement("div",{className:"phone-number-verification-upsell-image"}),i().createElement("div",{className:"verification-upsell-text-body text-description"},t(w,{phoneNumber:l})),i().createElement("button",{type:"button",className:"phone-number-change-number-button phone-number-text-button",onClick:function(){He(dt.verifyPhoneChangePhoneNumberPressed,{origin:p,section:b}),c({type:tt,pageName:ct})}},t("Action.ChangePhoneNumber")),i().createElement("label",{htmlFor:A},i().createElement("p",{className:"verification-code-label font-caption-header text-primary"},t(d))),i().createElement("input",{id:A,type:"text",inputMode:"numeric",className:"".concat(o.errorMessage?"input-field-error":""," form-control input-field input-number verification-code-input"),onChange:function(e){return e=e.target.value,c({type:Qe,errorMessage:""}),void v(un(un({},f),{},{code:an(e)}))},onPaste:function(e){e=an(e=(e.clipboardData||window.clipboardData).getData("text")),v({code:e,isReadyToSubmitCode:!0})},autoComplete:"one-time-code",placeholder:"000000",onKeyDown:function(e){"Enter"===e.key&&v(un(un({},f),{},{isReadyToSubmitCode:!0}))},onFocus:function(){He(dt.verifyPhoneCodeFieldPressed,{origin:p,section:b})},value:f.code}),i().createElement(Ut,{translate:t})),i().createElement(Ee.Modal.Footer,null,i().createElement("button",{type:"button",className:"btn-cta-md btn-max-width phone-number-verify-button",disabled:P||6!==f.code.length,onClick:function(){v(un(un({},f),{},{isReadyToSubmitCode:!0}))}},t("Action.Continue")),0===g?i().createElement("button",{type:"button",className:" btn-secondary-md btn-max-width phone-number-resent-button",onClick:function(){var e;He(dt.verifyPhoneResendPressed,{origin:p,section:b}),0===g&&(Ct(),0===g&&(e=setInterval((function(){E((function(t){return 1===t&&clearInterval(e),t-1}))}),1e3)),E(10))}},t(e)):i().createElement("button",{type:"button",className:" btn-secondary-md btn-max-width phone-number-resent-button btn-max-width resend-button-disabled"},t(N),i().createElement("span",null,O+g+T))))}vn.propTypes={translate:s().func.isRequired,onHide:s().func.isRequired};var yn=vn;function hn(e){function t(){d||(He(dt.phoneNumberModalDismissed,{origin:l.origin,section:u}),o(l.isPhoneVerified),s({type:Je}))}var n=e.translate,o=e.onClose,c=e.origin,l=(e=gt()).phoneUpsellState,s=e.dispatch,u=xt(l.pageName),d=(!!a.DeviceMeta&&(0,a.DeviceMeta)()).isInApp;return(0,r.useEffect)((function(){l.origin!==Ne&&He(dt.phoneNumberModalShown,{origin:l.origin,section:u})}),[l.pageName,l.origin]),(0,r.useEffect)((function(){s({type:it,origin:c})}),[]),i().createElement(Ee.Modal,{show:l.isOpen,onHide:t,className:d?"verification-modal phone-verification-webview":"verification-modal",size:"lg","aria-labelledby":"contained-modal-title-vcenter",scrollable:"true",centered:"true"},function(){switch(l.pageName){case ct:return i().createElement($t,{translate:n,onHide:t});case lt:return i().createElement(yn,{translate:n,onHide:t});case st:return i().createElement(Jt,{translate:n,onHide:t});case ut:return i().createElement(rn,{translate:n,onHide:t,origin:l.origin,shouldPrefillAffirmativeDiscoverabilityConsent:l.shouldPrefillAffirmativeDiscoverabilityConsent});default:return i().createElement($t,{translate:n,onHide:t})}}())}hn.propTypes={translate:s().func.isRequired,onClose:s().func.isRequired,origin:s().string},hn.defaultProps={origin:M};var bn=hn;function gn(e){var t=e.translate,n=e.onClose;e=e.origin;return i().createElement(yt,null,i().createElement(bn,{translate:t,onClose:n,origin:e}))}gn.propTypes={translate:s().func.isRequired,origin:s().string,onClose:s().func},gn.defaultProps={origin:void 0,onClose:function(){return null}};var En=(0,u.withTranslations)(gn,p),Pn="CLOSE_CONTACT_METHOD_PROMPT_MODAL",Sn="SET_LOGGING_VALUES";function Cn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xn(e,t){var n,r=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)),r}function Nn(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?xn(Object(n),!0).forEach((function(t){var r,i;r=e,t=n[i=t],i in r?Object.defineProperty(r,i,{value:t,enumerable:!0,configurable:!0,writable:!0}):r[i]=t})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):xn(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function wn(e,t){switch(t.type){case Pn:return Nn(Nn({},e),{},{isOpen:!1});case Sn:return Nn(Nn({},e),{},{origin:t.origin,section:t.section});default:return On}}function An(e){var t=e.children,n=(e=(n=function(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,c=e[Symbol.iterator]();!(r=(a=c.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==c.return||c.return()}finally{if(i)throw o}}return n}}(e,t)||function(e,t){if(e){if("string"==typeof e)return Cn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Cn(e,t):void 0}}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}((0,r.useReducer)(wn,On),2))[0],n[1]);return i().createElement(Tn.Provider,{value:{contactMethodPromptModalState:e,dispatch:n}},t)}var On={isOpen:!0,origin:"",section:""},Tn=(0,r.createContext)(On);An.propTypes={children:s().node.isRequired};M="contactMethodModal";var Mn={contactMethodPromptShown:{name:"contactMethodPromptShown",type:(O=_e.eventStreamService.eventTypes).modalAction,context:M,params:{aType:"shown"}},contactMethodPromptDismissed:{name:"contactMethodPromptDismissed",type:O.modalAction,context:M,params:{aType:"dismissed"}},contactMethodPromptEmailClicked:{name:"contactMethodPromptEmailClicked",type:O.buttonClick,context:M,params:{btn:"email"}},contactMethodPromptPhoneClicked:{name:"contactMethodPromptPhoneClicked",type:O.buttonClick,context:M,params:{btn:"phone"}},contactMethodPromptSupportClicked:{name:"contactMethodPromptSupportClicked",type:O.buttonClick,context:M,params:{btn:"support"}},contactMethodPromptLogoutClicked:{name:"contactMethodPromptLogoutClicked",type:O.buttonClick,context:M,params:{btn:"logout"}}};function kn(){return(0,r.useContext)(Tn)}function Rn(e){function t(e){e||null!==a.UpsellService&&void 0!==a.UpsellService&&a.UpsellService.renderContactMethodPromptModal({origin:o.origin,section:o.section})}var n=e.translate,r=e.onHide,o=kn().contactMethodPromptModalState;e="Action.AddEmailAddress";return i().createElement("div",null,i().createElement(Ee.Modal.Header,{useBaseBootstrapComponent:!0},i().createElement("div",{className:"verification-upsell-title-container"},i().createElement(Ee.Modal.Title,{id:"contained-modal-title-vcenter"},n("Heading.VerificationRequired")))),i().createElement(Ee.Modal.Body,{className:"verification-grid"},i().createElement("span",{className:"icon-spot-passcode-xl verification-grid-icon"}),i().createElement("div",null,i().createElement("div",{className:"verification-upsell-title-container page-title "},i().createElement("div",{className:"font-header-2"},n("Heading.DontGetLockedOut"))),i().createElement("div",{className:"text-description"},n("Label.RecoverIfPasswordLost"))),i().createElement("span",{className:"icon-spot-success-xl verification-grid-icon"}),i().createElement("div",null,i().createElement("div",{className:"verification-upsell-title-container page-title"},i().createElement("div",{className:"font-header-2"},n("Heading.ImproveAccountSecurity"))),i().createElement("div",{className:"text-description"},n("Label.KeepBadActorsOut")))),i().createElement(Ee.Modal.Footer,null,i().createElement("button",{type:"button",className:"btn-cta-md btn-max-width phone-number-verify-button",onClick:function(){r(),He(Mn.contactMethodPromptPhoneClicked,{origin:o.origin,section:o.section}),null!==a.UpsellService&&void 0!==a.UpsellService&&a.UpsellService.renderPhoneUpsell({onClose:t})}},n("Action.AddPhoneNumber")),i().createElement("button",{type:"button",className:" btn-secondary-md btn-max-width phone-number-resent-button",onClick:function(){r(),He(Mn.contactMethodPromptEmailClicked,{origin:o.origin,section:o.section}),null!==a.UpsellService&&void 0!==a.UpsellService&&a.UpsellService.renderEmailUpsell(t)}},n(e)),i().createElement("div",null,i().createElement("div",{className:"contact-method-prompt-links"},i().createElement(Ee.Link,{className:"text-default contact-method-link-button",href:"https://en.help.roblox.com/hc/articles/203313350",target:"_blank",onClick:function(){He(Mn.contactMethodPromptSupportClicked,{origin:o.origin,section:o.section})}},n("Action.Support")),i().createElement("button",{type:"button",className:"text-default contact-method-link-button",onClick:function(){He(Mn.contactMethodPromptLogoutClicked,{origin:o.origin,section:o.section}),a.NavigationService.logoutAndRedirect()}},n("Action.LogOutText"))))))}Rn.propTypes={translate:s().func.isRequired,onHide:s().func.isRequired};var In=Rn;function Dn(e){function t(){He(Mn.contactMethodPromptDismissed,{origin:c.origin,section:c.section}),l({type:Pn})}var n=e.translate,o=e.origin,a=e.section,c=(e=kn()).contactMethodPromptModalState,l=e.dispatch;return(0,r.useEffect)((function(){l({type:Sn,origin:o,section:a})}),[]),(0,r.useEffect)((function(){c.origin&&c.section&&He(Mn.contactMethodPromptShown,{origin:c.origin,section:c.section})}),[c.origin,c.section]),i().createElement(Ee.Modal,{show:c.isOpen,onHide:t,keyboard:!1,className:"verification-modal",backdrop:"static",size:"lg","aria-labelledby":"contained-modal-title-vcenter",scrollable:"true",centered:"true"},i().createElement(In,{translate:n,onHide:t}))}Dn.propTypes={translate:s().func.isRequired,section:s().string.isRequired,origin:s().string.isRequired};var jn=Dn;function Un(e){var t=e.translate,n=e.origin;e=e.section;return i().createElement(An,null,i().createElement(jn,{translate:t,origin:n,section:e}))}Un.propTypes={translate:s().func.isRequired,origin:s().string.isRequired,section:s().string.isRequired};var _n=(0,u.withTranslations)(Un,p);c().UpsellService={renderEmailUpsell:function(e){(0,n.ready)((function(){var t=document.getElementById(d);t&&((0,o.unmountComponentAtNode)(t),(0,o.render)(i().createElement(Xe,null),t),Te(e))}))},renderPhoneUpsell:function(e){var t=(e=0<arguments.length&&void 0!==e?e:{}).onClose,r=e.origin;(0,n.ready)((function(){var e=document.getElementById("phoneVerificationUpsell-container");e&&((0,o.unmountComponentAtNode)(e),(0,o.render)(i().createElement(En,{onClose:t,origin:r}),e))}))},renderContactMethodPromptModal:function(e){var t=e.origin,r=e.section;(0,n.ready)((function(){var e=document.getElementById("contactMethodPrompt-container");e&&((0,o.unmountComponentAtNode)(e),(0,o.render)(i().createElement(_n,{origin:t,section:r}),e))}))}},c().EmailVerificationService={handleUserEmailUpsellAtLogout:k,handleUserEmailUpsellAtBuyRobux:function(e){return Oe({origin:"buyRobuxPage",skipCallback:e})},handleUserEmailUpsellOnHomePage:Te,handleUserEmailVerificationRequiredByPurchaseWarning:function(){return Oe({origin:"purchaseWarning",requireVerification:!0})},handleUserEmailUpsellAtPremiumSubscription:function(e){return Oe({origin:"premiumSubscriptionPage",skipCallback:e})}},(0,n.ready)((function(){document.getElementById(d)&&(0,o.render)(i().createElement(Xe,null),document.getElementById(d))}))}(),window.Roblox&&window.Roblox.BundleDetector&&window.Roblox.BundleDetector.bundleDetected("VerificationUpsell");