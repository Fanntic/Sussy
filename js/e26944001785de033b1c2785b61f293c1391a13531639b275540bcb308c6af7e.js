!function(){"use strict";var e,t={n:function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,{a:n}),n},d:function(e,n){for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},o:function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}},n=Roblox,r=t.n(n),o=React,i=t.n(o),a=ReactDOM,l=ReactStyleGuide,s=ReactUtilities,c="enterEmail",u="enterCode",d="Response.TooManyAttemptsPleaseWait",E="email",f=function(){return(f=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function p(t,n){var r=f({},t);switch(n.type){case e.SET_ENTER_EMAIL_PAGE:return r.emailVerifyCodeModalPage=c,r;case e.SET_ENTER_CODE_PAGE:return r.emailVerifyCodeModalPage=u,r;case e.SET_EMAIL:return r.email=n.email,r;case e.SET_SESSION_TOKEN:return r.sessionToken=n.sessionToken,r;case e.SET_OTP_CODE:return r.code=n.code,r;case e.SET_LOADING:return r.isLoading=n.isLoading,r;case e.SET_ERROR:return r.errorMessage=n.errorMessage,r;case e.CLOSE_MODAL:return r.isModalOpen=!1,r;default:return t}}function m(e){var t=e.children,n=(e=(n=(0,o.useReducer)(p,b))[0],n[1]);return i().createElement(O.Provider,{value:{state:e,dispatch:n}},t)}function g(e){return new RegExp("^\\w+([-_+.]\\w+)*@\\w+([-.]\\w+)*\\.\\w+([-.]\\w+)*$").test(e)}function v(e){M.eventStreamService.sendEventWithTarget(R.pageLoad,e,{})}function h(e,t,n,r,o){var i={};i.field=t,n&&(i.btn=n),r&&(i.atype=r),o&&(i.errorCode=o),M.eventStreamService.sendEventWithTarget(R.formInteraction,e,i)}function T(e,t){var n=e===w.context.enterOTP?w.btn.resendCode:void 0;h(e,w.field.errorMessage,n,w.aType.shown,t)}function y(e,t){M.eventStreamService.sendEventWithTarget(R.buttonClick,e,{btn:t})}function S(e){return n.EnvironmentUrls.apiGatewayUrl+"/otp-service/v1/"+e}(_=e=e||{})[_.SET_ENTER_EMAIL_PAGE=0]="SET_ENTER_EMAIL_PAGE",_[_.SET_ENTER_CODE_PAGE=1]="SET_ENTER_CODE_PAGE",_[_.SET_EMAIL=2]="SET_EMAIL",_[_.SET_SESSION_TOKEN=3]="SET_SESSION_TOKEN",_[_.SET_OTP_CODE=4]="SET_OTP_CODE",_[_.SET_LOADING=5]="SET_LOADING",_[_.SET_ERROR=6]="SET_ERROR",_[_.CLOSE_MODAL=7]="CLOSE_MODAL";var b={emailVerifyCodeModalPage:c,email:"",sessionToken:"",code:"",isLoading:!1,errorMessage:"",isModalOpen:!0},O=(0,o.createContext)(null),C=function(){var e=(0,o.useContext)(O);if(null===e)throw new Error("EmailVerifyCodeModalContext was not provided in the current scope");return e},_={common:["Common.Captcha"],feature:"Authentication.Login"},w={eventName:{loginOtherDevice:"loginOtherDevice",formValidation:"formValidation"},context:{loginPage:"loginPage",loginForm:"LoginForm",landingPage:"Multiverse",signupForm:"MultiverseSignupForm",sendOTP:"sendOTP",enterOTP:"enterOTP",disambiguationOTP:"disambiguationOTP",disambiguationEmail:"disambiguationEmail",disambiguationPhone:"disambiguationPhone"},aType:{buttonClick:"buttonClick",click:"click",offFocus:"offFocus",focus:"focus",shown:"shown"},field:{loginOtherDevice:"loginOtherDevice",loginOTP:"loginOTP",loginSubmitButtonName:"loginSubmit",password:"password",username:"username",signupSubmitButtonName:"signupSubmit",appButtonClickName:"AppLink",showPassword:"showPassword",hidePassword:"hidePassword",birthdayDay:"birthdayDay",birthdayMonth:"birthdayMonth",birthdayYear:"birthdayYear",signupUsername:"signupUsername",signupPassword:"signupPassword",signupEmail:"signupEmail",parentEmail:"parentEmail",genderMale:"genderMale",genderFemale:"genderFemale",email:"email",otpCode:"OTPcode",errorMessage:"errorMessage",accountSelection:"accountSelection"},btn:{cancel:"cancel",sendCode:"sendCode",resendCode:"resendCode",login:"login"},input:{redacted:"[Redacted]"},origin:{webVerifiedSignup:"WebVerifiedSignup"}},M=CoreRobloxUtilities,R=M.eventStreamService.eventTypes,P=(0,s.withTranslations)((function(t){function n(){y(S,w.btn.sendCode),c()}var r=t.titleText,a=t.descriptionText,c=t.onSendCode,u=t.email,d=t.errorMessage,E=t.onClose,f=t.dispatch,p=t.translate,m=(t=(0,o.useState)(!0))[0],T=t[1],S=w.context.sendOTP,b=(0,s.useDebounce)(u,200);return(0,o.useEffect)((function(){m&&0<u.length&&(T(!1),h(w.context.sendOTP,w.field.email)),!g(b)&&0<b.length?f({type:e.SET_ERROR,errorMessage:p("Response.InvalidEmail")}):f({type:e.SET_ERROR,errorMessage:""})}),[b]),(0,o.useEffect)((function(){v(S)}),[]),i().createElement(o.Fragment,null,i().createElement(l.Modal.Header,{title:r,onClose:function(){y(S,w.btn.cancel),E()}}),i().createElement(l.Modal.Body,null,i().createElement("p",{className:"email-verify-code-help-text"},a),i().createElement("input",{placeholder:p("Label.Email"),onChange:function(t){return t=t.target.value,void f({type:e.SET_EMAIL,email:t})},type:"email",autoFocus:!0,className:"form-control input-field email-verify-code-input",autoComplete:"email",maxLength:320,onKeyPress:function(e){"Enter"===e.key&&g(u)&&n()},value:u}),i().createElement("p",{className:"text-error input-validation email-verify-code-error-text"},d),i().createElement(l.Button,{className:"email-verify-code-button",variant:l.Button.variants.secondary,isDisabled:!g(u),onClick:n},p("Action.SendCode"))))}),_),L=(0,s.withTranslations)((function(t){function n(){var e;T(!1),0===S&&(e=setInterval((function(){b((function(t){return 1===t&&(clearInterval(e),T(!0)),t-1}))}),1e3)),b(30)}var r=t.titleText,a=t.descriptionText,c=t.code,u=t.codeLength,d=t.onResendCode,E=t.isLoading,f=t.errorMessage,p=t.onClose,m=t.dispatch,g=t.translate,T=(t=(_=(0,o.useState)(!0))[0],_[1]),S=(_=(0,o.useState)(0))[0],b=_[1],O=(_=(0,o.useState)(!0))[0],C=_[1],_=(0,s.useDebounce)(c,200),M=w.context.enterOTP;return(0,o.useEffect)((function(){O&&0<c.length&&(C(!1),h(w.context.enterOTP,w.field.otpCode))}),[_]),(0,o.useEffect)((function(){v(M),n()}),[]),i().createElement(o.Fragment,null,i().createElement(l.Modal.Header,{title:r,onClose:function(){y(M,w.btn.cancel),p()}}),i().createElement(l.Modal.Body,null,i().createElement("p",{className:"email-verify-code-help-text"},a),i().createElement("input",{placeholder:g("Label.LoginCode"),onChange:function(t){return function(t){m({type:e.SET_ERROR,errorMessage:""}),t=t.replace(/\D/g,""),m({type:e.SET_OTP_CODE,code:t})}(t.target.value)},type:"text",inputMode:"numeric",maxLength:u,autoFocus:!0,className:"form-control input-field email-verify-code-input",value:c,disabled:E}),i().createElement("p",{className:"text-error email-verify-code-error-text"},f),E?i().createElement(l.Loading,null):i().createElement(l.Button,{className:"email-verify-code-button",variant:l.Button.variants.secondary,onClick:function(){y(M,w.btn.resendCode),d(),n()},isDisabled:!t},t?g("Action.Resend"):g("Label.CodeSent")+" ("+S+")"),i().createElement("div",{className:"font-caption-header email-verify-code-help-link"},i().createElement("a",{className:"text-link",href:"https://en.help.roblox.com/hc/articles/11014749736980",target:"_blank",rel:"noreferrer"},g("Label.LearnMore")))))}),_),x=CoreUtilities,D=function(e,t,n,r){return new(n=n||Promise)((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},N=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:l(0),throw:l(1),return:l(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},k=function(e,t,n,r){return new(n=n||Promise)((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function l(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):((t=e.value)instanceof n?t:new n((function(e){e(t)}))).then(a,l)}s((r=r.apply(e,t||[])).next())}))},A=function(e,t){var n,r,o,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]},a={next:l(0),throw:l(1),return:l(2)};return"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function l(a){return function(l){return function(a){if(n)throw new TypeError("Generator is already executing.");for(;i;)try{if(n=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=0<(o=i.trys).length&&o[o.length-1])&&(6===a[0]||2===a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],r=0}finally{n=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,l])}}},I=(0,s.withTranslations)((function(t){t.containerId;var n=t.codeLength,r=t.onEmailCodeEntered,a=t.onModalAbandoned,f=t.enterEmailTitle,p=t.enterEmailDescription,m=t.enterCodeTitle,g=t.enterCodeDescription,v=t.origin,h=t.translate,b=C(),O=(V=b.state).emailVerifyCodeModalPage,_=V.email,M=V.sessionToken,R=V.code,I=V.isLoading,V=(t=V.errorMessage,V.isModalOpen),G=b.dispatch,F=(0,s.useDebounce)(R,200);function B(t,n){var r=t.data;t=t.status;return 6===r?(G({type:e.SET_ERROR,errorMessage:h(d)}),void T(n,String(r))):429===t?(G({type:e.SET_ERROR,errorMessage:h(d)}),void T(n,String(t))):3===r?(T(n,String(r)),void K()):(T(n,String(r)),void G({type:e.SET_ERROR,errorMessage:h("Response.UnknownError")}))}(0,o.useEffect)((function(){F.length===n&&(r(M,F),G({type:e.SET_LOADING,isLoading:!0}),y(w.context.enterOTP,w.btn.login))}),[F]),(0,o.useEffect)((function(){function t(t){if(t.detail){if(t.detail.shouldCloseModal)return void U();G({type:e.SET_ERROR,errorMessage:t.detail.errorMessage})}G({type:e.SET_OTP_CODE,code:""}),G({type:e.SET_LOADING,isLoading:!1})}return window.addEventListener("onEnterEmailVerifyCodeError",t),function(){window.removeEventListener("onEnterEmailVerifyCodeError",t)}}),[]);var U=function(){a(),G({type:e.CLOSE_MODAL})},K=function(){return k(void 0,void 0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(r={origin:v,contactType:E,contactValue:_},D(void 0,void 0,Promise,(function(){var e;return N(this,(function(t){switch(t.label){case 0:return e={url:e=S("sendCode"),withCredentials:!0},[4,x.httpService.post(e,r)];case 1:return[2,t.sent().data]}}))})))];case 1:return t=n.sent(),G({type:e.SET_SESSION_TOKEN,sessionToken:null!==(t=null==t?void 0:t.otpSessionToken)&&void 0!==t?t:""}),G({type:e.SET_ERROR,errorMessage:""}),G({type:e.SET_ENTER_CODE_PAGE}),[3,3];case 2:return B(t=n.sent(),w.context.sendOTP),[3,3];case 3:return[2]}var r}))}))};return i().createElement(l.Modal,{className:"email-verify-code-modal",show:V,size:"lg",backdrop:"static",onHide:U},i().createElement(o.Fragment,null,O===c&&i().createElement(P,{titleText:f,descriptionText:p,onSendCode:K,email:_,errorMessage:t,onClose:U,dispatch:G,translate:h}),O===u&&M&&i().createElement(L,{titleText:m,descriptionText:g,code:R,codeLength:n,onResendCode:function(){return k(void 0,void 0,void 0,(function(){var t;return A(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,(r={contactType:E,otpSessionToken:M},D(void 0,void 0,Promise,(function(){var e;return N(this,(function(t){switch(t.label){case 0:return e={url:e=S("resendCode"),withCredentials:!0},[4,x.httpService.post(e,r)];case 1:return[2,t.sent().data]}}))})))];case 1:return t=n.sent(),G({type:e.SET_SESSION_TOKEN,sessionToken:null!==(t=null==t?void 0:t.otpSessionToken)&&void 0!==t?t:""}),G({type:e.SET_ERROR,errorMessage:""}),[3,3];case 2:return B(t=n.sent(),w.context.enterOTP),[3,3];case 3:return[2]}var r}))}))},isLoading:I,errorMessage:t,onClose:U,dispatch:G,translate:h})))}),_);_={renderEmailVerifyCodeModal:_=function(e){var t=e.emailVerifyCodeError,n=e.containerId,r=e.codeLength,o=e.onEmailCodeEntered,l=e.onModalAbandoned,s=e.enterEmailTitle,c=e.enterEmailDescription,u=e.enterCodeTitle,d=e.enterCodeDescription,E=e.origin,f=e.translate;return null!=(e=document.getElementById(n))&&((0,a.unmountComponentAtNode)(e),(0,a.render)(i().createElement(m,null,i().createElement(I,{emailVerifyCodeError:t,containerId:n,codeLength:r,onEmailCodeEntered:o,onModalAbandoned:l,enterEmailTitle:s,enterEmailDescription:c,enterCodeTitle:u,enterCodeDescription:d,origin:E,translate:f})),e),!0)}};Object.assign(r(),{EmailVerifyCodeModalService:_})}(),window.Roblox&&window.Roblox.BundleDetector&&window.Roblox.BundleDetector.bundleDetected("EmailVerifyCodeModal");